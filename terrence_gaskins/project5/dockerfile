# Use a slim JVM base
FROM openjdk:17-slim

WORKDIR /app

# Install tools and Scala
RUN apt-get update && \
    apt-get install -y --no-install-recommends wget ca-certificates && \
    wget -q https://downloads.lightbend.com/scala/2.13.12/scala-2.13.12.tgz && \
    tar -xzf scala-2.13.12.tgz && \
    mv scala-2.13.12 /usr/share/scala && \
    rm scala-2.13.12.tgz && \
    apt-get clean && rm -rf /var/lib/apt/lists/*

ENV PATH="/usr/share/scala/bin:${PATH}"
ENV SCALA_HOME="/usr/share/scala"

# Copy source code
COPY BaltimoreHomicide.scala .

# Compile and confirm class file exists
RUN scalac BaltimoreHomicide.scala && ls -l

# Run the compiled program with argument forwarding
ENTRYPOINT ["scala", "-classpath", ".", "BaltimoreHomicide"]
